{"version":3,"file":"index.js","sources":["../src/js/render-functions.js","../src/js/constants.js","../src/js/pixabay-api.js","../src/main.js"],"sourcesContent":["/**\n * Generate image string with data\n *\n * @param webformatURL\n * @param largeImageURL\n * @param tags\n * @param likes\n * @param views\n * @param comments\n * @param downloads\n * @return string\n */\nexport const generateImageGalleryItem = ({webformatURL, largeImageURL, tags, likes, views, comments, downloads}) => `\n<li class=\"gallery-item\">\n  <a class=\"gallery-link\" href=\"${largeImageURL}\">\n    <img\n      class=\"gallery-image\"\n      src=\"${webformatURL}\"\n      alt=\"${tags}\"\n      width=\"360\"\n      height=\"200\"\n    />\n  </a>\n  <ul>\n    <li>\n        <h3>Likes</h3>\n        <p>${likes}</p>\n    </li>\n    <li>\n        <h3>Views</h3>\n        <p>${views}</p>\n    </li>\n    <li>\n        <h3>Comments</h3>\n        <p>${comments}</p>\n    </li>\n    <li>\n        <h3>Downloads</h3>\n        <p>${downloads}</p>\n    </li>\n  </ul>\n</li>\n`;\n\n/**\n * Render images to gallery\n *\n * @param data\n */\nexport function renderImages(data) {\n    const gallery = document.getElementById('gallery');\n    const imageElements = data.map(generateImageGalleryItem).join('');\n\n    gallery.insertAdjacentHTML('afterbegin', imageElements);\n}\n\nexport function loadMoreImages(data) {\n  const gallery = document.getElementById('gallery');\n  const imageElements = data.map(generateImageGalleryItem).join('');\n\n  gallery.insertAdjacentHTML('beforeend', imageElements);\n}","export const errorMessage = 'Something went wrong with your request. Please try again.';\nexport const PUBLIC_API_KEY = '49464671-8ab53a49f1e625c6669932451';\nexport const errorNotFoundMessage = 'Sorry, there are no images matching your search query. Please try again!';\nexport const reachedEndResultsErrorMessage = 'We\\'re sorry, but you\\'ve reached the end of search results.';","import iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\nimport axios from 'axios';\nimport {errorMessage} from './constants.js';\n\n\n/**\n * Fetch Image Data\n *\n * @param url\n * @return {Promise<any>}\n */\nexport async function fetchImages(url) {\n    try {\n        const { data } = await axios.get(url);\n\n        return data;\n    } catch (e) {\n        console.log(e);\n\n        iziToast.error({\n            message: errorMessage,\n            position: 'topRight'\n        });\n    }\n}","import iziToast from 'izitoast';\nimport SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\nimport 'izitoast/dist/css/iziToast.min.css';\nimport {loadMoreImages, renderImages} from './js/render-functions.js';\nimport {fetchImages} from './js/pixabay-api.js';\nimport {errorMessage, errorNotFoundMessage, PUBLIC_API_KEY, reachedEndResultsErrorMessage} from './js/constants.js';\n\nconst form = document.querySelector('form');\nconst gallery = document.getElementById('gallery');\nconst loader = document.querySelector('.loader');\nconst loadMoreButton = document.querySelector('.load-more');\nconst instance = new SimpleLightbox('#gallery a', {\n  captions: true,\n  captionType: 'attr',\n  captionDelay: 250,\n  showCounter: false,\n  captionsData: 'alt'\n});\nlet currentPage = 1;\nlet searchCriteria = '';\n\nform.addEventListener('submit', async (event) => {\n  event.preventDefault();\n  currentPage = 1;\n\n  const input = event.target.querySelector('input');\n  const url = `https://pixabay.com/api/?key=${PUBLIC_API_KEY}&q=${encodeURI(input.value)}&image_type=photo&orientation=horizontal&safesearch=true?page=${currentPage}&per_page=15`;\n\n  searchCriteria = input.value;\n\n  gallery.innerHTML = '';\n  loader.classList.add('loading');\n  loadMoreButton.classList.add('hidden');\n\n  try {\n    const data = await fetchImages(url);\n\n    if (!data.hits.length) {\n      return iziToast.error({\n        message: errorNotFoundMessage,\n        position: 'topRight'\n      });\n    }\n\n    renderImages(data.hits);\n    instance.refresh();\n    loadMoreButton.classList.remove('hidden');\n  } catch (e) {\n    console.log(e);\n\n    return iziToast.error({\n      message: errorMessage,\n      position: 'topRight'\n    });\n  } finally {\n    loader.classList.remove('loading');\n    form.reset();\n  }\n});\n\nloadMoreButton.addEventListener('click', async () => {\n  currentPage += 1;\n  loadMoreButton.classList.add('hidden');\n  loader.classList.add('loading');\n\n  const url = `https://pixabay.com/api/?key=${PUBLIC_API_KEY}&q=${encodeURIComponent(searchCriteria)}&image_type=photo&orientation=horizontal&safesearch=true&page=${currentPage}&per_page=15`;\n\n  try {\n    const data = await fetchImages(url);\n    const { height: imageHeight} = document.querySelector('.gallery-item').getBoundingClientRect();\n\n    if (!data.hits.length) {\n      currentPage = 1;\n      iziToast.error({\n        message: reachedEndResultsErrorMessage,\n        position: 'topCenter'\n      })\n    }\n\n    loadMoreImages(data.hits);\n    instance.refresh();\n    window.scrollBy({\n      top: window.innerHeight - imageHeight / 2,\n      behavior: 'smooth',\n    });\n    loadMoreButton.classList.remove('hidden');\n  } catch (e) {\n    console.log(e);\n    currentPage = 1;\n\n    return iziToast.error({\n      message: errorMessage,\n      position: 'topRight'\n    });\n  } finally {\n    loader.classList.remove('loading');\n  }\n});"],"names":["generateImageGalleryItem","webformatURL","largeImageURL","tags","likes","views","comments","downloads","renderImages","data","gallery","imageElements","loadMoreImages","errorMessage","PUBLIC_API_KEY","errorNotFoundMessage","reachedEndResultsErrorMessage","fetchImages","url","axios","iziToast","form","loader","loadMoreButton","instance","SimpleLightbox","currentPage","searchCriteria","event","input","e","imageHeight"],"mappings":"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"}